---
  machine:
    node:
      version: "iojs-v2.3.0"
    environment:
  test:
    override:
      - npm run test
  deployment:
    npm:
      branch: master
      commands:
        - git config --global user.email 'circleci.agent@paulcuth.me.uk'
        - git config --global user.name "CircleCI"
        - node ci/bump-project-version
        - grunt grunt-plugin
        - node ci/sync-plugin-version
        - node ci/tag
        - echo "//registry.npmjs.org/:_authToken=$NPM_AUTH_TOKEN" > ~/.npmrc
        - npm publish dist/build-tools/grunt-starlight
